# This is a template Makefile generated by rpcgen

# Output directories
OUT_DIR = out
OBJ_DIR = $(OUT_DIR)/obj

# Parameters

CLIENT = $(OUT_DIR)/messaging_client
SERVER = $(OUT_DIR)/messaging_server

SOURCES_CLNT.c = 
SOURCES_CLNT.h = 
SOURCES_SVC.c = 
SOURCES_SVC.h = 
SOURCES.x = messaging.x

TARGETS_SVC.c = messaging_svc.c messaging_server.c messaging_xdr.c 
TARGETS_CLNT.c = messaging_clnt.c messaging_client.c messaging_xdr.c 
TARGETS = messaging.h messaging_xdr.c messaging_clnt.c messaging_svc.c messaging_client.c messaging_server.c

OBJECTS_CLNT = $(SOURCES_CLNT.c:%.c=$(OBJ_DIR)/%.o) $(TARGETS_CLNT.c:%.c=$(OBJ_DIR)/%.o)
OBJECTS_SVC = $(SOURCES_SVC.c:%.c=$(OBJ_DIR)/%.o) $(TARGETS_SVC.c:%.c=$(OBJ_DIR)/%.o)

# Compiler flags 

CFLAGS += -g -I/usr/include/tirpc 
LDLIBS += -ltirpc -pthread
RPCGENFLAGS =

# Targets 

all:	makedirs $(CLIENT) $(SERVER)

makedirs:
	@mkdir -p $(OUT_DIR)
	@mkdir -p $(OBJ_DIR)

$(TARGETS):	$(SOURCES.x) 
	rpcgen $(RPCGENFLAGS) $(SOURCES.x)

$(OBJ_DIR)/%.o:	%.c
	$(COMPILE.c) $(OUTPUT_OPTION) $<

$(CLIENT):	$(OBJECTS_CLNT) 
	$(LINK.c) -o $(CLIENT) $(OBJECTS_CLNT) $(LDLIBS) 

$(SERVER):	$(OBJECTS_SVC) 
	$(LINK.c) -o $(SERVER) $(OBJECTS_SVC) $(LDLIBS)

clean:
	$(RM) -r $(OUT_DIR)
	$(RM) core $(TARGETS)

